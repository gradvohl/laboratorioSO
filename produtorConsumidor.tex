\chapter{Problema do Produtor-Consumidor}
Um dos problemas discutidos em sala de aula é o do produtor-consumidor. Em linhas gerais, existem dois processos (ou \textit{threads}), um produtor e um consumidor, que competem pelo uso de um recurso. Nesse caso um \textit{buffer}.

O produtor gera dados e os armazena no \textit{buffer}. O consumidor, por sua vez, lê dados do buffer e os utiliza. A região crítica é o \textit{buffer}, pois apenas um dos processos deve estar utilizando o \textit{buffer} a cada instante. O sistema operacional deve prover meios de garantir essa exclusão mútua.

%Existem várias formas de se resolver esse problema. Nesse laboratório serão mostradas duas delas. A primeira utilizando \textit{multithread} e uma estratégia chamada \texttt{mutex}. A segunda usando multiprocessamento e semáforos.

\section{Problema do Produtor-Consumidor com \textit{multithreads} e semáforos}
Para resolver o problema do Produtor-Consumidor com multithread serão criados três semáforos mutex, vazio e cheio, conforme a solução vista em sala de aula.

Observe as primitivas para inicializar semáforos (\texttt{sem\_init}), para executar a operação \textit{up} (\texttt{sem\_post}) e para executar a operação \textit{down} (\texttt{sem\_wait}).

Com base nessa explicação, observe o programa a seguir: 
\lstinputlisting[style=MyCStyle]{./Programas/Semaforos/prod_cons.c}

\subsection{Exercício}
Antes de compilar o programa, mude para o diretório onde se encontra o arquivo \texttt{principal.c} , com o seguinte comando:

\begin{lstlisting}[style=MyBashStyle]
cd ../Semaforos
\end{lstlisting}

Compile e execute o programa anterior com as seguintes linhas de comando:

\begin{lstlisting}[style=MyBashStyle]
gcc -pthread prod_cons.c  -o prod_cons
./prod_cons
\end{lstlisting}